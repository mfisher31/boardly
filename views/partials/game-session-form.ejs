<% 
    var selectedGameId = session ? session.game_id : game_id;
    var sessionDate = session ? session.session_date.toISOString().split('T')[0] : new Date().toISOString().split('T')[0];
    var playersCount = session ? session.players_count : 2;
    var sessionNotes = session ? (session.notes || '') : '';
    var buttonText = session ? 'Update' : 'Add';
    var cancelUrl = session ? '/sessions/' + session.game_id : '/';
%>
<form method="POST" action="<%= action %>">
    <div class="form-group">
        <label for="game_id">Game:</label>
        <select id="game_id" name="game_id" class="form-control" required>
            <option value="">Select a game...</option>
            <% games.forEach(function(game) { %>
                <option value="<%= game.id %>" <%= (selectedGameId === game.id) ? 'selected' : '' %>><%= game.name %></option>
            <% }); %>
        </select>
    </div>
    
    <div class="form-group">
        <label for="session_date">Session Date:</label>
        <input type="date" id="session_date" name="session_date" 
               class="form-control" value="<%= sessionDate %>" required>
    </div>
    
    <div class="form-group">
        <label for="players_count">Number of Players:</label>
        <input type="number" id="players_count" name="players_count" 
               class="form-control" min="1" value="<%= playersCount %>" required>
    </div>
    
    <div class="form-group">
        <label for="notes">Notes:</label>
        <textarea id="notes" name="notes" class="form-control" rows="4"><%= sessionNotes %></textarea>
    </div>
    <br>
    <button type="submit" class="btn btn-primary"><%= buttonText %></button>
    <a href="<%= cancelUrl %>" class="btn btn-secondary">Cancel</a>
</form>
